<HTML>
  <HEAD>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <TITLE>i5/OS Programmer's Toolkit - MI/EMI Programmer's Guide</TITLE>
    <link href="tabs.css" rel="stylesheet" type="text/css">
    <link href="doxygen.css" rel="stylesheet" type="text/css">
    <link href="docs.css" rel="stylesheet" type="text/css">

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left">
          <a href="http://sourceforge.net/donate/index.php?group_id=254578"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" alt="Support This Project" /> </a>
        </td>
        <td align="right">
          <a href="http://sourceforge.net/projects/i5toolkit"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=254578&amp;type=13" width="120" height="30" alt="Get i5/OS Programmer's Toolkit at SourceForge.net. Fast, secure and Free Open Source software downloads" /></a>
        </td>

      </tr>
    </table>

  </HEAD>
  <body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="page_attr">Analyzing Program Attributes </a></h1>The MATPG instruction allow us to retrieve either program-attribute information of an OPM MI program. These attributes are important for understanding the behaviour of an MI program. They're also necessary when you are going to re-complie an MI program from disassembled MI source. Attributes of an MI program can be categorized into the following categories:<ul>
<li><a class="el" href="page_attr.html#ss_attr_run">Runtime Attributes</a></li><li><a class="el" href="page_attr.html#ss_attr_gen">Code-generation Attributes</a></li><li><a class="el" href="page_attr.html#ss_attr_obs">Observation Attributes</a></li></ul>
<h2><a class="anchor" name="s_attr">
Attributes of an MI Program</a></h2>
To retrieve the attributes of an MI program, you need to invoke MI instruction MATPG on a system pointer to a OPM program. The receiver template for instruction MATPG has been defined as DS matpg_tmpl_t in mih52.rpgleinc, and as SPC matpg-t in mip-h.emi, for ILE RPG language and MI language respectively. <dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="page_attr.html#ss_attr_matpg_tmpl_t">Declaration of MATPG's Receiver Template in ILE RPG</a> <p>
<a class="el" href="page_attr.html#ss_attr_matpg_t">Declaration of MATPG's Receiver Template in MI</a> </dd></dl>
<dl class="todo" compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>links</dd></dl>
In the following discussion, elements of SPC object matpg_t will be cited for simpilicity.<h3><a class="anchor" name="ss_attr_run">
Runtime Attributes</a></h3>
The following table lists runtime program attributes and corresponding MIC options.<p>
<table border="1" cellspacing="3" cellpadding="3">
<tr bgcolor="silver">
<td>Attribute </td><td>Value and Meaning </td><td>QPRCRTPG Option </td><td>Comment <p>
</td></tr>
<tr>
<td rowspan="2">Adopt owner's authority </td><td>pgm-attr.bit 0 = 0. Do NOT adopt program owner's user profile on invocation. </td><td>*USER </td><td rowspan="2">You can set this attribute to yes by either creating a program with the parameter USRPRF(*OWNER) or changing a program by CL command CHGPGM with parameter USRPRF(*OWNER) <p>
</td></tr>
<tr>
<td>pgm-attr.bit 0 = 1. Adopt program owner's user profile on invocation. </td><td>*ADOPT <p>
</td></tr>
<tr>
<td rowspan="3">Array constraint </td><td>pgm-attr.bit 1 = 0. Arrays are constrained. </td><td>*SUBSCR </td><td>This requests additional run-time checks to ensure that references to array elements are not outside the bounds of the declare statement. This option causes the resulting program to run slower. <p>
</td></tr>
<tr>
<td>pgm-attr.bit 1 = 0 <b>AND</b> expgm-attr.bit 0 = 0. Does not constrain arrays. </td><td>*NOSUBSCR </td><td>The results of references to array elements outside the bounds of the declare statement are not defined. <p>
</td></tr>
<tr>
<td>pgm-attr.bit 1 = 0 <b>AND</b> expgm-attr.bit 0 = 1. Fully unconstrained. </td><td>*UNCON </td><td>This ensures that references to array elements outside the bounds of the declare statement act as if the array element actually exists. <p>
</td></tr>
<tr>
<td rowspan="2">String constraint </td><td>pgm-attr.bit 2 = 0. Strings are constrained. </td><td>*SUBSTR </td><td>This requests additional run-time checks to ensure that references to character strings are not outside the bounds of the declare statement. This option causes the resulting program to run slower. <p>
</td></tr>
<tr>
<td>pgm-attr.bit 2 = 1. Strings are NOT constrained. </td><td>*NOSUBSTR </td><td>The results of substring references outside the bounds of the declare statement are not defined. <p>
</td></tr>
<tr>
<td rowspan="2">Adopted user profile propagation </td><td>pgm-attr.bit 4 = 0. Adopted user profile authorities are not propagated to external invocations. </td><td>When *ONWER is not specified. </td><td rowspan="2">Note that IBM provides neither a CL command nor a application programming interface to change this attribute of a program. It is automatically set or changed to the same value with the adopt-owner-authority attribute for a non-IBM program. <p>
</td></tr>
<tr>
<td>pgm-attr.bit 4 = 1. Adopted user profile authorities are propagated to all subinvocations. </td><td>*OWNER <p>
</td></tr>
<tr>
<td rowspan="2">Initialize static storage </td><td>pgm-attr.bit 5 = 0. Initialize storage to binary 0. </td><td>*CLRPSSA </td><td rowspan="2">Static storage is allocated the first time a program is called. It remains allocated until explicitly deallocated.<ul>
<li>*CLRPSSA = Initializes static storage. This code clears the program static storage area (PSSA) on entry using the Call External (CALLX) MI instruction.</li><li>*NOCLRPSSA = Does not initialize the PSSA.  </li></ul>
<p>
</td></tr>
<tr>
<td>pgm-attr.bit 5 = 1. Do NOT initialize storage to binary 0. </td><td>*NOCLRPSSA <p>
</td></tr>
<tr>
<td rowspan="2">Initialize automatic storage </td><td>pgm-attr.bit 6 = 0. Initialize storage to binary 0. </td><td>*CLRPASA </td><td rowspan="2">Automatic storage is allocated each time a program runs and automatically deallocated when no longer needed.<ul>
<li>*CLRPASA = Initializes automatic storage. This code clears the program automatic storage area (PASA) on entry using the Call External (CALLX) MI instruction.</li><li>*NOCLRPASA = Does not initialize the PASA.  </li></ul>
<p>
</td></tr>
<tr>
<td>pgm-attr.bit 6 = 1. Do NOT initialize storage to binary 0. </td><td>*NOCLRPASA <p>
</td></tr>
<tr>
<td rowspan="2">Associated journal entry </td><td>pgm-attr.bit 7 = 0. Program name is recorded in journal entries. </td><td>- </td><td rowspan="2">The associated journal entry field controls which program is associated with a journal entry. As a journal entry is made, a newest-to-oldest interrogation of the invocation stack is performed. The first program encountered that has the associated journal entry field set to program name is recorded in journal entries is associated with the journal entry by a record of the program name in the journal entry. If a program is encountered for which the associated journal entry field is set to program name is not recorded in journal entry, the program is ignored unless the program is on the top of the invocation stack. If the program is on the top of the invocation stack, it is associated with the journal entry by a record of the program name in the journal entry. <br>
 For example, this attribute of APIs that operate database files (e.g. QDBOPEN, QDBPUT) is 1; while this attribute of user programs is always 0.  <p>
</td></tr>
<tr>
<td>pgm-attr.bit 7 = 1. Program name is NOT recorded in journal entries. </td><td>- <p>
</td></tr>
<tr>
<td>Update PASA stack </td><td>pgm-attr.bit 8. </td><td>- </td><td text="red">This field is now obsolete. It will be ignored. <p>
</td></tr>
<tr>
<td rowspan="2">Suppress decimal data exception </td><td>pgm-attr.bit 9 = 0. Decimal exceptions are NOT to be suppressed </td><td>*NOIGNDEC </td><td rowspan="2">- <p>
</td></tr>
<tr>
<td>pgm-attr.bit 9 = 1. Decimal exceptions are to be suppressed </td><td>*IGNDEC <p>
</td></tr>
<tr>
<td rowspan="2">Template extension existence </td><td>pgm-attr.bit 10 = 0. Template extension does NOT exist </td><td>- </td><td rowspan="2">The template extension existence field indicates whether or not there is an extension (<em>matpg.expgm-attr</em>) to the program template.  <p>
</td></tr>
<tr>
<td>pgm-attr.bit 10 = 1. Template extension exists </td><td>- <p>
</td></tr>
<tr>
<td rowspan="2">Suppress previously adopted user profiles </td><td>pgm-attr.bit 11 = 0. Do not suppress previously adopted user profiles </td><td>*ADPAUT </td><td rowspan="2">To set the suppress-previously-adopted-user-profiles attribute of a program to yes, issue CHGPGM command on the program with parameter USEADPAUT (*NO). <p>
</td></tr>
<tr>
<td>pgm-attr.bit 11 = 1. Suppress previously adopted user profiles </td><td>*NOADPAUT <p>
</td></tr>
<tr>
<td rowspan="2">Template version </td><td>pgm-attr.bits 12-15 = 0000. Version 0 </td><td>- </td><td rowspan="2">The template version is important in the following ways:<ul>
<li>For version 0, size of an operand in the instruction stream is 2 bytes, while, for version 1, size of an operand in the instruction stream is 3 bytes.</li><li>Template version 0 limits the number of instructions to a maximum of 65,532 and the number of ODV entries to a maximum of 8,191. Programs that exceed one of these maximums cannot be created with template version 0. Template version 1 limits the number of instructions to a maximum of 65,532 and the number of ODV entries to a maximum of 65,526. Programs that exceed one of these maximums cannot be created with template version 1.  </li></ul>
<p>
</td></tr>
<tr>
<td>pgm-attr.bits 12-15 = 0001. Version 1 </td><td>- <p>
</td></tr>
</table>
<h3><a class="anchor" name="ss_attr_gen">
Code-generation Attributes</a></h3>
<table border="1" cellspacing="3" cellpadding="3">
<tr bgcolor="silver">
<td>Attribute </td><td>Value and Meaning </td><td>QPRCRTPG Option </td><td>Comment <p>
</td></tr>
<tr>
<td rowspan="2">Performance optimization </td><td>gen-opt.bit 0 = 0. No optimization </td><td>*NOOPT </td><td>This does not optimize the program. This requests the normal level code optimization when you create the program.  <p>
</td></tr>
<tr>
<td>gen-opt.bit 0 = 1. Perform optimization </td><td>*OPT </td><td>This optimizes the program. In most instances, this produces the smallest and best running program. Occasionally, the source program may signal a MCH2802 escape message during processing. If this occurs, you should not optimize the program.  <p>
</td></tr>
<tr>
<td rowspan="2">Space pointer machine objects </td><td>gen-opt.bit 1 = 0. Disallow space pointer machine objects in ODV component. </td><td>- </td><td rowspan="2">- <p>
</td></tr>
<tr>
<td>gen-opt.bit 1 = 1. Allow space pointer machine objects in ODV component. </td><td>- <p>
</td></tr>
<tr>
<td rowspan="2">Coincident operand overlap </td><td>gen-opt.bit 2 = 0. Do not assume coincident operand overlap. </td><td>*NOOVERLAP </td><td>Does not support coincident operands. If you specify *NOOVERLAP, you guarantee that coincident operand overlap will not occur while running the instruction. Therefore, the system can use the receiver on an instruction as a work area during operations performed to produce the final result. Using the receiver as a work area does not use as much processor resource as would be required to move the final result from an internal work area to the receiver.  <p>
</td></tr>
<tr>
<td>gen-opt.bit 2 = 1. Assume coincident operand overlap. </td><td>*OVERLAP </td><td>Supports coincident operands. If you specify *OVERLAP, the operands on an MI instruction may overlap. Therefore, the system cannot use the receiver on an instruction as a work area during operations that produce the final result. This can require more processor resource for running the instruction but it ensures valid results if an overlap occurs.  <p>
</td></tr>
<tr>
<td rowspan="2">Teraspace capable </td><td>gen-opt.bit 5 = 0. Do not generate teraspace capable program. </td><td>- </td><td rowspan="2">User programs can NOT be created as teraspace-capable. <p>
</td></tr>
<tr>
<td>gen-opt.bit 5 = 1. Generate teraspace capable program. </td><td>- <p>
</td></tr>
<tr>
<td rowspan="2">Executable part compression </td><td>gen-opt.bit 6 = 0. Do not compress executable part. </td><td>- </td><td rowspan="2">- <p>
</td></tr>
<tr>
<td>gen-opt.bit 6 = 1. Compress executable part. </td><td>- <p>
</td></tr>
<tr>
<td rowspan="2">Observation part compression </td><td>gen-opt.bit 7 = 0. Do not compress observation part. </td><td>- </td><td rowspan="2">- <p>
</td></tr>
<tr>
<td>gen-opt.bit 7 = 1. Compress observation part. </td><td>- <p>
</td></tr>
</table>
<h3><a class="anchor" name="ss_attr_obs">
Observation Attributes</a></h3>
<table border="1" cellspacing="3" cellpadding="3">
<tr bgcolor="silver">
<td>Attribute </td><td>Value and Meaning <p>
</td></tr>
<tr>
<td rowspan="2">Instruction stream </td><td>obs-attr.bit 0 = 0. Not materializable. <p>
</td></tr>
<tr>
<td>obs-attr.bit 0 = 1. Materializable. <p>
</td></tr>
<tr>
<td rowspan="2">ODT Directory Vector (ODV) </td><td>obs-attr.bit 1 = 0. Not materializable. <p>
</td></tr>
<tr>
<td>obs-attr.bit 1 = 1. Materializable. <p>
</td></tr>
<tr>
<td rowspan="2">ODT Entry String (OES) </td><td>obs-attr.bit 2 = 0. Not materializable. <p>
</td></tr>
<tr>
<td>obs-attr.bit 2 = 1. Materializable. <p>
</td></tr>
<tr>
<td rowspan="2">Breakpoint Offset Mapping (BOM) table </td><td>obs-attr.bit 3 = 0. Not materializable. <p>
</td></tr>
<tr>
<td>obs-attr.bit 3 = 1. Materializable. <p>
</td></tr>
<tr>
<td rowspan="2">Symbol table </td><td>obs-attr.bit 4 = 0. Not materializable. <p>
</td></tr>
<tr>
<td>obs-attr.bit 4 = 1. Materializable. <p>
</td></tr>
<tr>
<td rowspan="2">Object Mapping Table (OMT) </td><td>obs-attr.bit 5 = 0. Not materializable. <p>
</td></tr>
<tr>
<td>obs-attr.bit 5 = 1. Materializable. <p>
</td></tr>
</table>
<h2><a class="anchor" name="s_appendix">
Appendix</a></h2>
<h3><a class="anchor" name="ss_attr_matpg_tmpl_t">
Declaration of MATPG's Receiver Template in ILE RPG</a></h3>
Please refer to mih52.rpgleinc for the current version of <em>matpg_tmpl_t</em>.<p>
<dl class="todo" compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>link</dd></dl>
<h3><a class="anchor" name="ss_attr_matpg_t">
Declaration of MATPG's Receiver Template in MI</a></h3>
Please refer to mip-h.emi for the current version of <em>matpg_t</em>. <div class="fragment"><pre class="fragment">dcl spc matpg-t bas(*)                              ;
        dcl dd matpg?bytes-in   bin(4)          dir ;
        dcl dd matpg?bytes-out  bin(4)          dir ;
        dcl dd matpg?pgm-<span class="keywordtype">id</span>     <span class="keywordtype">char</span>(32)        dir ;
        dcl dd matpg?pgm-type           <span class="keywordtype">char</span>(2) def(matpg?pgm-<span class="keywordtype">id</span>) pos(1) ;
        dcl dd matpg?pgm-name           <span class="keywordtype">char</span>(30) def(matpg?pgm-<span class="keywordtype">id</span>) pos(3) ;
        dcl dd matpg?crt-opt    <span class="keywordtype">char</span>(4)         dir ;
        dcl dd *                <span class="keywordtype">char</span>(4)         dir ;
        dcl dd matpg?spc-size   bin(4)          dir ;
        dcl dd matpg?spc-init-val <span class="keywordtype">char</span>(1)       dir ;
        dcl dd matpg?perf-cls   <span class="keywordtype">char</span>(4)         dir ;
        dcl dd *                <span class="keywordtype">char</span>(7)         dir ;
        dcl sysptr matpg?ctx                    dir ;
        dcl sysptr matpg?ag                     dir ;
        dcl dd matpg?pgm-attr   <span class="keywordtype">char</span>(2)         dir ;
        dcl dd matpg?gen-opt    <span class="keywordtype">char</span>(1)         dir ;
        dcl dd matpg?obsv-attr  <span class="keywordtype">char</span>(1)         dir ;
        dcl dd matpg?ss-size    bin(4) unsgnd   dir ; <span class="comment">/* size of static storage */</span>
        dcl dd matpg?as-size    bin(4) unsgnd   dir ; <span class="comment">/* size of automatic storage */</span>
        dcl dd matpg?num-inst1  bin(2) unsgnd   dir ; <span class="comment">/* number of instructions (1). for version number x'0000' */</span>
        dcl dd matpg?num-odv1   bin(2)          dir ; <span class="comment">/* number of ODV entries (1). for version number x'0000' */</span>
        dcl dd matpg?inss-off   bin(4)          dir ; <span class="comment">/* offset (in bytes) from beginning of template to the instruction stream component */</span>
        dcl dd matpg?odv-off    bin(4)          dir ; <span class="comment">/* odv offset */</span>
        dcl dd matpg?oes-off    bin(4)          dir ; <span class="comment">/* oes offset */</span>
        dcl dd matpg?bome-len   bin(4)          dir ; <span class="comment">/* length of BOM entry */</span>
        dcl dd matpg?bom-len    bin(4)          dir ; <span class="comment">/* length of BOM component */</span>
        dcl dd matpg?bom-off    bin(4)          dir ; <span class="comment">/* bom offset */</span>
        dcl dd matpg?symtble-len bin(4)         dir ; <span class="comment">/* length of symbol table entry */</span>
        dcl dd matpg?symtbl-len bin(4)          dir ; <span class="comment">/* length of symbol component */</span>
        dcl dd matpg?symtbl-off bin(4)          dir ; <span class="comment">/* symbol table offset */</span>
        dcl dd matpg?omt-off    bin(4)          dir ; <span class="comment">/* omt offset */</span>
        dcl dd matpg?num-inst2  bin(4)          dir ; <span class="comment">/* number of instructions (2). for version number x'0001' */</span>
        dcl dd matpg?num-odv2   bin(4)          dir ; <span class="comment">/* number of ODV entries (2). for version number x'0001' */</span>
        <span class="comment">/* template extension */</span>
        dcl dd matpg?expgm-attr <span class="keywordtype">char</span>(4)         dir ; <span class="comment">/* extended program attributes */</span>
        dcl dd matpg?lang-vrm   <span class="keywordtype">char</span>(2)         dir ; <span class="comment">/* language VRM. V/R/M: bits 4-7/8-11/12-15 */</span>
        dcl dd matpg?bom-flags  <span class="keywordtype">char</span>(1)         dir ; <span class="comment">/* bit 0: BOM format. bits 1-7: user data5A. */</span>
        dcl dd matpg?udata5b    <span class="keywordtype">char</span>(7)         dir ; <span class="comment">/* user data5B */</span>
        dcl dd matpg?pgm-vrm    <span class="keywordtype">char</span>(2)         dir ; <span class="comment">/* program VRM. */</span>
        dcl dd matpg?retrns     <span class="keywordtype">char</span>(1)         dir ; <span class="comment">/* bit 0 = 1, All data required for machine retranslation is present. */</span>
        dcl dd *                <span class="keywordtype">char</span>(47)        dir ; <span class="comment">/* reserved (binary 0) */</span>
        <span class="comment">/*</span>
<span class="comment"> Program data</span>
<span class="comment">    Instruction stream component</span>
<span class="comment">    ODV component</span>
<span class="comment">    OES component</span>
<span class="comment"> BOM table</span>
<span class="comment"> Symbol table</span>
<span class="comment"> Object mapping table</span>
<span class="comment">         */</span>
</pre></div> </div>
<hr size="1">

<a href="http://sourceforge.net/donate/index.php?group_id=254578"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" alt="Support This Project" /> </a>

<address style="text-align: right;"><small>Generated on Tue May 10 19:55:10 2011 for i5/OS Programmer's Toolkit: OPM MI Disassembler by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9  </small></address>
</body>
</html>
