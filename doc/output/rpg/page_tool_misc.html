<HTML>
  <HEAD>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <TITLE>i5/OS Programmer's Toolkit - MI/EMI Programmer's Guide</TITLE>
    <link href="tabs.css" rel="stylesheet" type="text/css">
    <link href="doxygen.css" rel="stylesheet" type="text/css">
    <link href="docs.css" rel="stylesheet" type="text/css">

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left">
          <a href="http://sourceforge.net/donate/index.php?group_id=254578"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" alt="Support This Project" /> </a>
        </td>
        <td align="right">
          <a href="http://sourceforge.net/projects/i5toolkit"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=254578&amp;type=13" width="120" height="30" alt="Get i5/OS Programmer's Toolkit at SourceForge.net. Fast, secure and Free Open Source software downloads" /></a>
        </td>

      </tr>
    </table>

  </HEAD>
  <body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="page_tool_misc">Miscellaneous Tools </a></h1>Go back to <a href="../index.html">main page</a> of project <a href="https://sourceforge.net/projects/i5toolkit/">i5/OS Programmer's Toolkit </a>.<p>
Tools and utilities that are hard to be categorised are listed as the following:<ul>
<li><a class="el" href="page_tool_misc.html#s_tool_misc_cvthc">The CVTHC Program</a></li></ul>
<h2><a class="anchor" name="s_tool_misc_cvthc">
The CVTHC Program</a></h2>
Like its MI cousin (the CVTHC (Convert Hex to Charater) instruction), the CVTHC program converts each hex digit (4-bit value) in the source character string to a character (8-bit value) in the receiver character string. It's a tiny OPM MI program which contains only 18 OPM MI instructions.<p>
The reason of the CVTHC program's birth is quite simple, it is handy for an OPM or ILE HLL program to convert a hexadecimal value to character format. The CVTHC instruction cannot be used in a bound program (an ILE program). Also, an OPM HLL program cannot use MI instructions, and hence cannot utilize the CVTHC instruction. Although service program QSYS/QC2UTIL1 exports a procedure, <em>cvthc</em>, that implements the functionality of the CVTHC instruction, the <em>cvthc</em> procedure is really inconvenient to use, since the user must bind to *SRVPGM QSYS/QC2UTIL1 directly or indirectly via the *BNDDIR QSYS/QC2LE. While, using the CVTHC program in a ILE HLL program is convenient, you need to do nothing but an external program call.<p>
The CVTHC program has three parameters:<ul>
<li>[out] Receiver character string</li><li>[in] Source character string</li><li>[in] bin(4). Length in nibbles of source</li></ul>
<p>
The following are pieces of HLL programs that utilize the CVTHC program.<ul>
<li>An OPM CL program that uses the CVTHC program to convert a 2-byte MI object type/subtype code to a character string. <div class="fragment"><pre class="fragment">   DCL        VAR(&amp;MITYP) TYPE(*UINT) LEN(2) VALUE(X'1901')
   DCL        VAR(&amp;MSG) TYPE(*CHAR) LEN(16)
   DCL        VAR(&amp;NIBLEN) TYPE(*UINT) LEN(4) VALUE(4)
   CALL       PGM(CVTHC) PARM(&amp;MSG &amp;MITYP &amp;NIBLEN)
</pre></div></li><li>In ILE CL program, <a href="https://i5toolkit.svn.sourceforge.net/svnroot/i5toolkit/cl/cl001.clle">cl001.clle</a>, the CVTHC program is used to convert the UUID generated by the GENUUID instruction to character format. <div class="fragment"><pre class="fragment">             PGM
             DCL        VAR(&amp;TMPL) TYPE(*CHAR) LEN(32)
             DCL        VAR(&amp;LEN) TYPE(*UINT) LEN(4) VALUE(32)
             DCL        VAR(&amp;BYTESIN) TYPE(*INT) STG(*DEFINED) +
                          LEN(4) DEFVAR(&amp;TMPL)
             DCL        VAR(&amp;BYTESOUT) TYPE(*INT) STG(*DEFINED) +
                          LEN(4) DEFVAR(&amp;TMPL 5)
             DCL        VAR(&amp;UUID) TYPE(*CHAR) STG(*DEFINED) LEN(16) +
                          DEFVAR(&amp;TMPL 17)
             DCL        VAR(&amp;MSG) TYPE(*CHAR) LEN(32)
             DCL        VAR(&amp;NIBLEN) TYPE(*UINT) LEN(4) VALUE(32)

             CALLPRC    PRC('_PROPB') PARM((&amp;TMPL *BYREF) (X'00' +
                          *BYVAL) (&amp;LEN *BYVAL))
             CHGVAR     VAR(&amp;BYTESIN) VALUE(&amp;LEN)
             CALLPRC    PRC('_GENUUID') PARM((&amp;TMPL *BYREF))
             CALL       PGM(CVTHC) PARM(&amp;MSG &amp;UUID &amp;NIBLEN)

             SNDPGMMSG  MSG(&amp;MSG)
             ENDPGM
</pre></div></li><li>ILE COBOL program <a href="https://i5toolkit.svn.sourceforge.net/svnroot/i5toolkit/cobol/test/cbl002.cblle">cbl002.cblle</a> does the same thing as ILE CL program <a href="https://i5toolkit.svn.sourceforge.net/svnroot/i5toolkit/cl/cl001.clle">cl001.clle</a>. <div class="fragment"><pre class="fragment">       process
           NOMONOPRC.

       <span class="keywordtype">id</span> division.
       program-<span class="keywordtype">id</span>. cbl002.

       environment division.
       configuration section.
       special-names.
           copy mih-lnktyp.

       data division.
       working-storage section.
           copy mih-spt.
       01 result pic x(32).
       01 tmpl   type uuid-t.
       01 uuid-len pic 9(9) usage comp-4 value 32.

       procedure division.
       main-pgm.

           move all x<span class="stringliteral">"00"</span> to tmpl.
           move 32 to bytes-in of tmpl.
           call <span class="stringliteral">"_GENUUID"</span> <span class="keyword">using</span>
               by reference tmpl.

           call program <span class="stringliteral">"CVTHC"</span> <span class="keyword">using</span>
               by reference result
               by reference uuid of tmpl
               by reference uuid-len.
           display <span class="stringliteral">"UUID generated: "</span> result.

       see-you.
           stop run.
</pre></div> </li></ul>
</div>
<hr size="1">

<a href="http://sourceforge.net/donate/index.php?group_id=254578"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" alt="Support This Project" /> </a>

<address style="text-align: right;"><small>Generated on Tue May 10 19:55:09 2011 for i5/OS Programmer's Toolkit: System-builtin Headers for ILE RPG by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9  </small></address>
</body>
</html>
